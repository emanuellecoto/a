

create or replace PACKAGE BODY FIDE_CLINICA_DENTAL_FUNCTIONS_PKG AS

--FUNCION AUTOINCREMENT ALMACEN--
FUNCTION ID_ALMACEN_SEQ
RETURN NUMBER IS
V_INCREMENT NUMBER;
BEGIN
    V_INCREMENT := FIDE_ALMACEN_SQ.NEXTVAL ;
    RETURN V_INCREMENT;
END ID_ALMACEN_SEQ;

--FUNCION AUTOINCREMENT USUARIO--
FUNCTION ID_USUARIO_SEQ
RETURN NUMBER IS
V_INCREMENT NUMBER;
BEGIN
    V_INCREMENT := FIDE_USUARIO_SQ.NEXTVAL ;
    RETURN V_INCREMENT;
END ID_USUARIO_SEQ;


--FUNCION RETORNAR UN ESTADO--

FUNCTION ESTADO_RETORNAR_ESTADO_FN(
    V_ID_USUARIO IN NUMBER
) RETURN VARCHAR2 IS 

V_ESTADO_SOLICITADO FIDE_USUARIO_TB.ID_ESTADO%TYPE;
BEGIN

    SELECT ID_ESTADO INTO V_ESTADO_SOLICITADO 
    FROM FIDE_USUARIO_TB 
    WHERE ID_USUARIO = V_ID_USUARIO;
    
    
    IF V_ESTADO_SOLICITADO = 'A' THEN
        UPDATE FIDE_USUARIO_TB 
        SET ID_ESTADO = 'I'
        WHERE ID_USUARIO = V_ID_USUARIO;
        RETURN 'I';


    ELSIF V_ESTADO_SOLICITADO = 'I' THEN
        UPDATE FIDE_USUARIO_TB 
        SET ID_ESTADO = 'A'
        WHERE ID_USUARIO = V_ID_USUARIO;
        RETURN 'A';
    END IF;
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN 'NO EXISTE ESA ID';
    WHEN OTHERS THEN
        RETURN 'NO EXISTE ESA ID';
END ESTADO_RETORNAR_ESTADO_FN;



END;
